{% load url from future %}

<!doctype html>
<html lang="en">
<head>
  <title>Ajax test</title>
</head>
<body>
  <div id="map_canvas" style="height: 400px; width: 600px;"></div>
  <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
  <script type="text/javascript" src="{{MEDIA_URL}}core/js/jquery.ui.map.full.min.js"></script>
  <script>
    var center, mapOptions;
    center = new google.maps.LatLng(0, 0);
    mapOptions = new google.maps.MapOptions({
      center: center,
      zoom: 15
    });
    jQuery(document).ready(function($) {
      $('#map_canvas').gmap(mapOptions).bind('init', function() { 
        $.ajax({
          'url': '{% url 'global_project_map_json' %}'
        }).done(function(data) {
          $.each( data, function(unused_iterator, marker) {
            $('#map_canvas').gmap('addMarker', { 
              'position': new google.maps.LatLng(marker.latitude, marker.longitude), 
              'bounds': true 
            });
            /*.click(function() {
              $('#map_canvas').gmap('openInfoWindow', { 'content': marker.content }, this);
            });
            */
          });
        });
      });
    });
  </script>
</body>
